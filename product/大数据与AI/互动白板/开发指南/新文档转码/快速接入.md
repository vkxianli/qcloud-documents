新文档转码使用的是 Cos 的文档转码能力，相对于旧的转码方案接入简单，只需要在 Cos 控制台开通文档转码功能即可使用。关于对象存储文档预览更多信息请查看具体的 [文档预览概述文档](https://cloud.tencent.com/document/product/436/45906)。

## 最新转码方案的优势

1. 接入简单，只需 URL 和一个接口就可以体验到最新转码。
2. 兼容性好，旧的方案中有一些特殊元素不支持，在新转码方案中可以支持。

## 适用互动白板版本

互动白板从`2.6.0`的版本开始支持新的转码方案。

## 转码服务开通

1. 进入腾讯云 [对象存储控制台](https://console.cloud.tencent.com/cos5/bucket)。
2. 在左侧导航中，单击【存储桶列表】，单击需要开启文档预览功能的存储桶，进入存储桶管理页。
3. 单击左侧的【数据处理】>【文档处理】，在【文档处理】配置项中，单击【编辑】，将状态修改为开启即开通了转码服务。
![](https://main.qcloudimg.com/raw/bf707853edf44238fbefbe7115af75b2.png)


## 在互动白板中使用

### 获取课件的访问链接

将要转码的课件资源上传到 Cos 存储桶中，并获取课件的 URL。
![](https://main.qcloudimg.com/raw/3d5b8948fda4dc6fb58a7b75dc5371dd.png)
![](https://main.qcloudimg.com/raw/15ee0d8fcc19085916e1232697715334.png)


### 调用白板接口，将课件的 URL 设置到白板中

- 在上一步获取到的课件 URL 中拼接参数 for_tiw=1，for_tiw=1 作为识别新转码方案的标识，一定需要加上。
- 调用互动白板接口 addTranscodeFile 将 URL 设置到白板中。


```
// 以web端代码为例
// 示例三：2.6.0版本起，支持cos转码
teduBoard.addTranscodeFile({
    title: "欢迎新同学", // 文件标题
    url: "https://test-tic-1259648581.cos.ap-shanghai.myqcloud.com/%E6%AC%A2%E8%BF%8E%E6%96%B0%E5%90%8C%E5%AD%A6%20-%20%E5%BA%8F%E5%8F%B7%20(1).ppt?for_tiw=1" // cos资源的url，且携带for_tiw=1的参数
}, false)
```

完成以上两步，转码到添加到互动白板中工作就已经完成了。

## 支持转码格式
目前互动白板中只支持：doc(x)、ppt(x) 和 PDF 文档；暂时不支持 excel 和 txt 文档转码。


## 特殊说明

1. 由于两个方案对 PPT 的动画处理方式不太一样，新旧版本兼容会存在一些步数同步的问题，故互动白板中不做新旧版本转码同步兼容。
2. 如果您是新接入用户，建议您将所有端的版本都接入到最新的2.6.0+的版本，就可以体验最新的转码。
3. 如果您目前线上只有 web 端，可以将互动白板升级到2.6.0+的版本，就可以体验最新的转码。
4. 如果您目前线上还有存量移动端，客户端低于2.6.0的版本，也建议您提前接入2.6.0+版本，在存量用户都升级到2.6.0+的版本后，就可以体验最新的转码。
5. 新转码方案中，如果 PPT 中有未支持的动画，会采用默认的动画来代替，保证可以将 PPT 转码成功，这个现象是符合预期的。
6. 新转码方案暂时不支持缩略图。
7. 新转码方案暂时不支持全量获取每一页对应的步数。
