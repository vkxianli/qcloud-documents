
本文将为您介绍如何操作后台任务详情。

## 前提条件


应用性能监控目前处于内测阶段，如需体验需通过 [应用性能监控内测申请](https://cloud.tencent.com/apply/p/f5yvbf09mka)。

## 操作步骤


1. 登录 [应用性能监控-后台任务](https://console.cloud.tencent.com/tapm/backstagetask)，进入后台任务列表。
2. 在后台服务列表中，单击后台服务名称即可进入后台任务详情页。
3. 在后台任务详情页可查看 [概览](#overview)、[错误](#error)、[后台任务追踪](#track) 等相关数据，详细介绍如下：




## 概览[](id:overview)

### 后台任务拓扑图

系统以拓扑图的形式展示当前后台任务在统计周期内的调用关系。拓扑图中展示当前后台任务的请求时，当前业务系统中所有需要调用的应用和服务组件，以及当前业务系统之外，间接调用的其他业务系统。应用、服务组件和业务系统之间，以连线的形式展示当前后台任务所经过的调用关系。拓扑图上，当前后台任务的所属应用以【入口】的字样标注。如下图所示：
![](https://main.qcloudimg.com/raw/cc5c2f220beb9114e25f19495d0cb135.jpg)

- 将鼠标悬停在应用、服务组件或业务系统的图标上，可查看平均响应时间、平均吞吐率等具体信息。
- 单击图标名称可进入对应对象的概览页面。
- 拓扑图连线上展示在当前后台任务调用过程中应用之间、应用与服务组件之间、应用与其他业务系统之间调用的平均响应时间、平均吞吐率和平均错误率。



### 基本指标趋势图

展示当前后台任务在统计周期内的响应时间、请求和错误三个重要指标的历史趋势图。

- 响应时间：显示平均响应时间和4个自定义分位值响应时间的历史曲线，鼠标悬停在曲线上时显示当前时间点的对应响应时间指标数值并在其他两个趋势图中联动显示其他指标。右上角分别展示统计时间段内该后台任务的最大响应时间和平均响应时间。
- 请求：显示吞吐率的历史趋势图和请求数的条形图，并在其他两个趋势图中联动显示其他指标。右上角分别展示统计时间段内该后台任务的请求总次数和平均每秒请求数。
- 错误：显示当前后台任务错误率的趋势图和错误数的条形图，并在其他两个趋势图中联动显示其他指标。右上角的3个数值分别代表统计时间段内该后台任务发生的错误总次数、每分钟的错误数和平均错误率，不含异常的统计。



## 错误[](id:error)

在后台任务概览页面中，通过单击上方的【错误】页签可以查看当前后台任务所发生的错误统计情况。

- 错误率曲线图：错误率是指当前后台任务在粒度时间内发生错误和不影响事务的异常的次数，占总执行次数的百分比。
- TOP10 错误：显示在统计周期内当前后台任务出现次数最多的前10种错误的趋势图。
- 错误列表：显示在统计周期内当前后台任务出现的各种错误。单击错误条目可以查看当前错误每次发生的详细记录。默认按时间就近的顺序进行排序。

  

## 后台任务追踪[](id:track)

### 追踪列表

追踪列表项包括以下项目：

- 慢追踪：标注当前追踪是否是慢后台任务追踪。当显示慢后台任务标志时，单击可跳转到该慢后台任务追踪的详情页面，查看拓扑、调用栈、异常和参数信息。当没有该图标时，仅代表一次普通的后台任务记录。
- 时间：追踪产生的时间点，精确到秒。
- 追踪 ID：当前后台任务追踪的唯一 ID，单击可跳转到该慢后台任务追踪的详情页面。
- 后台任务名称：当前追踪的后台任务的名称，后台任务名称由探针自动识别或根据用户自定义的规则进行命名。
- 响应时间：该后台任务在应用中从开始执行到得到结果的时间。
- 应用：该后台任务所属的应用，单击可跳转到该应用概览页面。

  

 ### 追踪详情

 单击追踪 ID 可以进入该后台任务追踪的详情页。

 该页面展示此次后台任务访问中完整的全栈追踪信息，包括以下的功能和项目：
 ![](https://main.qcloudimg.com/raw/d1e22b0c11378542cae4c504b9a9d041.png)

- **追踪概览**：本次追踪的概览信息。包括：
	- 业务系统：此次追踪的后台任务所属的业务系统名称。
	- 应用：此次追踪后的台任务所属的应用名称。
	- 实例：此次追踪的台任务所属的应用下的实例名称。
	- 后台任务名称：该追踪的后台任务名称。
	- 追踪 ID：此次追踪的唯一 ID。
	- 异常数量：此次追踪过程中发生的异常次数，包括异常和错误。
	- 接口状态：此次后台任务执行的最终结果状态，包括成功和失败两种。
	- 开始时间：此次后台任务追踪的起始时间点。
	- 响应时间：此次后台任务执行的总时间。
- **性能分解图**：以饼图的形式展示本次追踪的性能分解，包含代码执行、数据库访问、NoSQL 访问、MQ 访问和外部调用（即外部服务）5部分的性能占比。外部服务是指应用通过 HTTP 等协议请求调用的外部应用的统称。

您可以查看关于后台任务的智能分析、拓扑、调用栈、异常、参数信息等数据。详细介绍如下：

<dx-tabs>
::: 智能分析
智能分析帮助用户分析当前的后台任务追踪信息，自动分析出该后台任务执行过程中最慢的代码段、最耗时的组件调用和最严重的错误和异常信息。点击代码段统计区域会跳转到调用栈页面。同时提供该后台任务追踪发生前后30分钟之内该后台任务所属应用的各个实例的JVM CPU、内存、线程和会话等指标的变化情况。
:::
::: 拓扑
拓扑图展示本次后台任务追踪的逻辑拓扑调用关系。拓扑展示本次追踪中所经过和访问的所有应用（包括所属业务系统的应用和其他相关的业务系统中的应用）、服务组件和外部服务及其调用关系和调用的过程。后台任务追踪中经过和访问的应用、服务组件和外部服务以图标的形式展示，调用关系和调用过程的数据以连线及连线上的文字标识来展示。
:::
::: 调用栈
详细调用图的形式展示本次追踪的代码调用过程，调用图中包括以下数据项：
	![](https://main.qcloudimg.com/raw/0f2efb24a99376fd97e4414fbccff3b3.png)
 - 代码段：此次追踪的后台任务执行过程中执行的代码段及其相关数据，包括代码段代码（类名.方法名）、该代码的调用堆栈。点击代码段名称可查看总执行时间、独占时间（该代码段自身的执行时间）、独占时间占比和偏移量（该代码段相对后台任务起始时间点的时间偏移量）。点击堆栈图标可查看代码堆栈。
 - SQL 调用：当代码段中调用数据库操作时，展示当时调用的数据库实例、执行时间、耗时占比、详细SQL
	语句和对应的代码堆栈。点击“数据库”小图标可在弹出对话框中查看详细的 SQL语句、数据库类型和具体的数据库实例。
 - NoSQL 调用：当代码段中调用NoSQL操作时，展示当时调用的NoSQL数据库实例、查询执行时间、耗时占比、详细NoSQL语句和对应的代码堆栈。点击“数据库”小图标可在弹出对话框中查看详细的 NoSQL语句、NoSQL类型和具体的NoSQL实例。
 - 外部调用：当代码中包含外部调用（例如：HTTP、Thrift、Dubbo等等）时，展示外部调用的URL、执行时间、服务类型等信息。点击外部服务图标可展示外部调用的名称、URL、使用的类库、执行的方法、以及后端应用的应用实例名称和服务接口名称等信息。当出现跨应用调用（下游应用上也安装了应用探针，并且相应的服务接口触发了服务接口追踪）时，展示下游应用和实例的名称，并可向下展开下游应用执行过程的代码段。
 - 异常：当后台任务执行过程中出现异常时，会以小图标的形式在代码段或各类调用最右边标注当前代码发生了异常。单击异常图标可在弹出的对话框里查看详细的异常信息和异常堆栈。
:::
::: 异常
异常页面集中展示当前后台任务追踪过程中捕获的所有异常信息。所有的异常信息按异常出现的时间顺序排列，列表中包括：
	![](https://main.qcloudimg.com/raw/0dd83819855b978611ab5530c4ea67f2.png)
- 偏移量：异常出现的时间点相对后台任务起始时间点的偏移量。
- 异常类型：异常类型包括后台任务错误（会导致后台任务失败）、代码异常、数据库异常、外部服务异常等多种类型。
- 异常名称：异常的名称，例如 Java 异常类名、404等状态码异常和数据库异常。
- 所属应用：发生该异常的应用名称。
- 所属实例：发生该异常的应用实例名称。
 单击异常列表中的条目，可在下方的内容区域查看对应异常的详细信息，包括异常或错误信息、错误类型和错误堆栈。
:::
::: 参数信息
参数信息页面展示此次后台任务追踪中采集到的所运行在的线程的名称，以及从方法参数或返回值中采集的用户自定义参数。
:::
</dx-tabs>
